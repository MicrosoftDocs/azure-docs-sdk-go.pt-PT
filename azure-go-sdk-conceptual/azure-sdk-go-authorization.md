---
title: Autenticação com o Azure SDK para Go
description: Saiba mais sobre os métodos de autenticação disponíveis no Azure SDK para Go e como utilizá-los.
services: azure
author: sptramer
ms.author: sttramer
ms.date: 04/03/2018
ms.topic: article
ms.service: azure
ms.devlang: go
manager: carmonm
ms.openlocfilehash: 39f9dc5a7cdf9ab84cfd9264446bacb31392ca80
ms.sourcegitcommit: 59d2b4c9d8da15fbbd15e36551093219fdaf256e
ms.translationtype: HT
ms.contentlocale: pt-PT
ms.lasthandoff: 04/18/2018
---
# <a name="authentication-methods-in-the-azure-sdk-for-go"></a><span data-ttu-id="9f14b-103">Métodos de autenticação no Azure SDK para Go</span><span class="sxs-lookup"><span data-stu-id="9f14b-103">Authentication methods in the Azure SDK for Go</span></span>

<span data-ttu-id="9f14b-104">O Azure SDK para Go oferece diversos tipos e métodos de autenticação que a sua aplicação pode utilizar.</span><span class="sxs-lookup"><span data-stu-id="9f14b-104">The Azure SDK for Go offers a variety of authentication types and methods that your application can use.</span></span> <span data-ttu-id="9f14b-105">Os métodos de autenticação suportados incluem a solicitação de informações a partir de variáveis do ambiente e a autenticação interativa baseada na Web.</span><span class="sxs-lookup"><span data-stu-id="9f14b-105">Supported authentication methods range from pulling information from environment variables to interactive web-based authentication.</span></span> <span data-ttu-id="9f14b-106">Este artigo apresenta os tipos de autenticação disponíveis no SDK e os métodos para utilizá-los.</span><span class="sxs-lookup"><span data-stu-id="9f14b-106">This article introduces you to the available types of authentication in the SDK, and the methods for using them.</span></span> <span data-ttu-id="9f14b-107">Também irá aprender as melhores práticas para selecionar o tipo de autenticação mais adequado para a sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-107">You'll also learn best practices for selecting which authentication type is right for your application.</span></span>

## <a name="available-authentication-types-and-methods"></a><span data-ttu-id="9f14b-108">Tipos e métodos de autenticação disponíveis</span><span class="sxs-lookup"><span data-stu-id="9f14b-108">Available authentication types and methods</span></span>

<span data-ttu-id="9f14b-109">O Azure SDK para Go oferece vários tipos diferentes de autenticação que utilizam conjuntos de credenciais diferentes.</span><span class="sxs-lookup"><span data-stu-id="9f14b-109">The Azure SDK for Go offers several different types of authentication, using different credentials sets.</span></span> <span data-ttu-id="9f14b-110">Cada um destes tipos de autenticação está disponível através de métodos de autenticação diferentes que são a forma como o SDK processa estas credenciais como entradas de dados.</span><span class="sxs-lookup"><span data-stu-id="9f14b-110">Each of these authentication types are available through different authentication methods, which are how the SDK takes these credentials as input.</span></span> <span data-ttu-id="9f14b-111">A tabela seguinte descreve os tipos de autenticação disponíveis e as situações em que são recomendados para utilização na sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-111">The following table describes the available types of authentication and situations in which they're recommended for use by your application.</span></span>

| <span data-ttu-id="9f14b-112">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="9f14b-112">Authentication type</span></span> | <span data-ttu-id="9f14b-113">Recomendado quando...</span><span class="sxs-lookup"><span data-stu-id="9f14b-113">Recommended when...</span></span> |
|---------------------|---------------------|
| <span data-ttu-id="9f14b-114">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="9f14b-114">Certificate-based authentication</span></span> | <span data-ttu-id="9f14b-115">Tem um certificado X509 configurado para um utilizador ou principal de serviço do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="9f14b-115">You have an X509 certificate that was configured for an Azure Active Directory (AAD) user or service principal.</span></span> <span data-ttu-id="9f14b-116">Para obter mais informações, consulte [Introdução à autenticação baseada em certificado no Azure Active Directory].</span><span class="sxs-lookup"><span data-stu-id="9f14b-116">To learn more, see [Get started with certificate-based authentication in Azure Active Directory].</span></span> |
| <span data-ttu-id="9f14b-117">Credenciais de cliente</span><span class="sxs-lookup"><span data-stu-id="9f14b-117">Client credentials</span></span> | <span data-ttu-id="9f14b-118">Tem um principal de serviço configurado para esta aplicação ou uma classe de aplicações a que pertence.</span><span class="sxs-lookup"><span data-stu-id="9f14b-118">You have a configured service principal that is set up for this application or a class of applications it belongs to.</span></span> <span data-ttu-id="9f14b-119">Para obter mais informações, consulte [Criar um principal de serviço com a CLI 2.0 do Azure].</span><span class="sxs-lookup"><span data-stu-id="9f14b-119">To learn more, see [Create a service principal with Azure CLI 2.0].</span></span> |
| <span data-ttu-id="9f14b-120">Identidade de Serviço Gerida (MSI)</span><span class="sxs-lookup"><span data-stu-id="9f14b-120">Managed Service Identity (MSI)</span></span> | <span data-ttu-id="9f14b-121">A aplicação está a ser executada num recurso do Azure configurado com Identidade de Serviço Gerida (MSI).</span><span class="sxs-lookup"><span data-stu-id="9f14b-121">Your application is running on an Azure resource that has been configured with Managed Service Identity (MSI).</span></span> <span data-ttu-id="9f14b-122">Para obter mais informações, consulte [Identidade de Serviço Gerida (MSI) para recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="9f14b-122">To learn more, see [Managed Service Identity (MSI) for Azure resources].</span></span> |
| <span data-ttu-id="9f14b-123">Token de dispositivo</span><span class="sxs-lookup"><span data-stu-id="9f14b-123">Device token</span></span> | <span data-ttu-id="9f14b-124">A aplicação destina-se a ser utilizada __apenas__ de forma interativa e terá diversos utilizadores, potencialmente a partir de múltiplos inquilinos do AAD.</span><span class="sxs-lookup"><span data-stu-id="9f14b-124">Your application is meant to be used interactively __only__ and will have a variety of users, potentially from multiple AAD tenants.</span></span> <span data-ttu-id="9f14b-125">Os utilizadores têm acesso a um browser para iniciar sessão.</span><span class="sxs-lookup"><span data-stu-id="9f14b-125">Users have access to a web browser to log in.</span></span> <span data-ttu-id="9f14b-126">Para obter mais informações, consulte [Utilizar a autenticação de token de dispositivo](#use-device-token-authentication).</span><span class="sxs-lookup"><span data-stu-id="9f14b-126">For more information, see [Use device token authentication](#use-device-token-authentication).</span></span>|
| <span data-ttu-id="9f14b-127">Nome de utilizador/palavra-passe</span><span class="sxs-lookup"><span data-stu-id="9f14b-127">Username/password</span></span> | <span data-ttu-id="9f14b-128">Tem uma aplicação interativa que não pode utilizar qualquer outro método de autenticação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-128">You have an interactive application that cannot use any other authentication method.</span></span> <span data-ttu-id="9f14b-129">Os utilizadores não têm a autenticação multifator ativada para o início de sessão do AAD.</span><span class="sxs-lookup"><span data-stu-id="9f14b-129">Your users do not have multi-factor authentication enabled for their AAD login.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="9f14b-130">Se utilizar outro tipo de autenticação que não as credenciais do cliente, a aplicação tem de estar registada no Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9f14b-130">If you use an authentication type other than client credentials, your application must be registered in Azure Active Directory.</span></span> <span data-ttu-id="9f14b-131">Para obter mais informações, consulte [Integrar aplicações no Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="9f14b-131">To learn how, see [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>

> [!NOTE]
> <span data-ttu-id="9f14b-132">A menos que tenha requisitos especiais, evite a autenticação de nome de utilizador/palavra-passe.</span><span class="sxs-lookup"><span data-stu-id="9f14b-132">Unless you have special requirements, avoid username/password authentication.</span></span> <span data-ttu-id="9f14b-133">Em situações em que o início de sessão baseado no utilizador é adequado, a autenticação de token de dispositivo pode ser utilizada como alternativa.</span><span class="sxs-lookup"><span data-stu-id="9f14b-133">In situations where user-based login is appropriate, device token authentication can usually be used instead.</span></span>

[Introdução à autenticação baseada em certificado no Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Get started with certificate-based authentication in Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Criar um principal de serviço com a CLI 2.0 do Azure]: /cli/azure/create-an-azure-service-principal-azure-cli
[Create a service principal with Azure CLI 2.0]: /cli/azure/create-an-azure-service-principal-azure-cli
[Identidade de Serviço Gerida (MSI) para recursos do Azure]: /azure/active-directory/managed-service-identity/overview
[Managed Service Identity (MSI) for Azure resources]: /azure/active-directory/managed-service-identity/overview

<span data-ttu-id="9f14b-137">Estes tipos de autenticação estão disponíveis através de métodos diferentes.</span><span class="sxs-lookup"><span data-stu-id="9f14b-137">These authentication types are available through different methods.</span></span> <span data-ttu-id="9f14b-138">A [_autenticação baseada no ambiente_ ](#use-environment-based-authentication) lê as credenciais diretamente a partir do ambiente do programa.</span><span class="sxs-lookup"><span data-stu-id="9f14b-138">[_Environment-based authentication_](#use-environment-based-authentication) reads credentials directly from the program's environment.</span></span> <span data-ttu-id="9f14b-139">A [_autenticação baseada em ficheiro_ ](#use-file-based-authentication) carrega um ficheiro que contém as credenciais do principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="9f14b-139">[_File-based authentication_](#use-file-based-authentication) loads a file containing service principal credentials.</span></span> <span data-ttu-id="9f14b-140">A [_autenticação baseada em cliente_ ](#use-an-authentication-client) utiliza um objeto no código do Go e torna-o responsável por fornecer as credenciais durante a execução do programa.</span><span class="sxs-lookup"><span data-stu-id="9f14b-140">[_Client-based authentication_](#use-an-authentication-client) uses an object in Go code and makes you responsible for providing the credentials during program execution.</span></span> <span data-ttu-id="9f14b-141">Por fim, a [ _autenticação de token de dispositivo_ ](#use-device-token-authentication) exige que os utilizadores iniciem sessão interativamente através de um browser com um token e não pode ser utilizada com a autenticação baseada no ambiente ou em ficheiros.</span><span class="sxs-lookup"><span data-stu-id="9f14b-141">Finally, [_Device token authentication_](#use-device-token-authentication) requires users to log in interactively through a web browser with a token, and cannot be used with environment- or file-based authentication.</span></span>

<span data-ttu-id="9f14b-142">Todas as funções de autenticação e tipos estão disponíveis no pacote `github.com/Azure/go-autorest/autorest/azure/auth`.</span><span class="sxs-lookup"><span data-stu-id="9f14b-142">All authentication functions and types are available in the `github.com/Azure/go-autorest/autorest/azure/auth` package.</span></span>

> [!NOTE]
> <span data-ttu-id="9f14b-143">Exceto se tiver requisitos especiais, evite utilizar a autenticação baseada no cliente.</span><span class="sxs-lookup"><span data-stu-id="9f14b-143">Unless you have special requirements, avoid client-based authentication.</span></span> <span data-ttu-id="9f14b-144">Este método de autenticação encoraja práticas incorretas.</span><span class="sxs-lookup"><span data-stu-id="9f14b-144">This method of authentication encourages bad practices.</span></span> <span data-ttu-id="9f14b-145">Em particular, utilizar a autenticação baseada em cliente convida à criação de credenciais hard-coded.</span><span class="sxs-lookup"><span data-stu-id="9f14b-145">In particular, using client-based authentication makes it tempting to hard-code credentials.</span></span> <span data-ttu-id="9f14b-146">Escrever código personalizado para autenticação também poderá resultar em erros em versões futuras do SDK caso os requisitos de autenticação mudem.</span><span class="sxs-lookup"><span data-stu-id="9f14b-146">Writing custom code for authentication may also break under future SDK releases if authentication requirements change.</span></span>

## <a name="use-environment-based-authentication"></a><span data-ttu-id="9f14b-147">Utilizar a autenticação baseada no ambiente</span><span class="sxs-lookup"><span data-stu-id="9f14b-147">Use environment-based authentication</span></span>

<span data-ttu-id="9f14b-148">Se estiver a executar a aplicação num ambiente rigorosamente controlado, tal como num contentor, a autenticação baseada no ambiente é uma opção de natural.</span><span class="sxs-lookup"><span data-stu-id="9f14b-148">If you're running your application in a tightly controlled environment such as in a container, environment-based authentication is a natural choice.</span></span> <span data-ttu-id="9f14b-149">Configure o ambiente da shell antes de executar a aplicação e o Go SDK lê estas variáveis de ambiente em runtime para efetuar a autenticação com o Azure.</span><span class="sxs-lookup"><span data-stu-id="9f14b-149">You configure the shell environment before running your application and the Go SDK reads these environment variables at runtime to authenticate with Azure.</span></span> 

<span data-ttu-id="9f14b-150">Autenticação baseada no ambiente suporta todos os métodos de autenticação, exceto os tokens de dispositivo, avaliados pela seguinte ordem: credenciais de cliente, certificados, nome de utilizador/palavra-passe e Identidade de Serviço Gerida (MSI).</span><span class="sxs-lookup"><span data-stu-id="9f14b-150">Environment-based authentication has support for all authentication methods except device tokens, evaluated in the following order: Client credentials, certificates, username/password, and Managed Service Identity (MSI).</span></span> <span data-ttu-id="9f14b-151">Se uma variável de ambiente necessária não estiver definida ou o SDK obtiver uma recusa do serviço de autenticação, é utilizado o tipo de autenticação seguinte.</span><span class="sxs-lookup"><span data-stu-id="9f14b-151">If a required environment variable is unset or the SDK gets a refusal from the authentication service, the next authentication type is tried.</span></span> <span data-ttu-id="9f14b-152">Se o SDK não conseguir efetuar a autenticação a partir do ambiente, devolve um erro.</span><span class="sxs-lookup"><span data-stu-id="9f14b-152">If the SDK cannot authenticate from the environment, it returns an error.</span></span>

<span data-ttu-id="9f14b-153">A tabela seguinte fornece detalhes sobre as variáveis de ambiente que têm de ser definidas para cada tipo de autenticação suportado pela autenticação baseada no ambiente.</span><span class="sxs-lookup"><span data-stu-id="9f14b-153">The following table details the environment variables that need to be set for each authentication type supported by environment-based authentication.</span></span>

| <span data-ttu-id="9f14b-154">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="9f14b-154">Authentication type</span></span> | <span data-ttu-id="9f14b-155">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="9f14b-155">Environment variable</span></span> | <span data-ttu-id="9f14b-156">Descrição</span><span class="sxs-lookup"><span data-stu-id="9f14b-156">Description</span></span> |
| ------------------- | -------------------- | ----------- |
| <span data-ttu-id="9f14b-157">__Credenciais de cliente__</span><span class="sxs-lookup"><span data-stu-id="9f14b-157">__Client credentials__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="9f14b-158">O ID do inquilino do Active Directory a que o principal de serviço pertence.</span><span class="sxs-lookup"><span data-stu-id="9f14b-158">The ID for the Active Directory tenant that the service principal belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="9f14b-159">O nome ou o ID do principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="9f14b-159">The name or ID of the service principal.</span></span> |
| | `AZURE_CLIENT_SECRET` | <span data-ttu-id="9f14b-160">O segredo associado ao principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="9f14b-160">The secret associated with the service principal.</span></span> |
| <span data-ttu-id="9f14b-161">__Certificado__</span><span class="sxs-lookup"><span data-stu-id="9f14b-161">__Certificate__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="9f14b-162">O ID do inquilino do Active Directory com o qual o certificado está registado.</span><span class="sxs-lookup"><span data-stu-id="9f14b-162">The ID for the Active Directory tenant that the certificate is registered with.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="9f14b-163">O ID de cliente de aplicação associado ao certificado.</span><span class="sxs-lookup"><span data-stu-id="9f14b-163">The application client ID associated with the certificate.</span></span> |
| | `AZURE_CERTIFICATE_PATH` | <span data-ttu-id="9f14b-164">O caminho para o ficheiro de certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="9f14b-164">The path to the client certificate file.</span></span> |
| | `AZURE_CERTIFICATE_PASSWORD` | <span data-ttu-id="9f14b-165">A palavra-passe do certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="9f14b-165">The password for the client certificate.</span></span> |
| <span data-ttu-id="9f14b-166">__Nome de Utilizador/Palavra-passe__</span><span class="sxs-lookup"><span data-stu-id="9f14b-166">__Username/Password__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="9f14b-167">O ID do inquilino do Active Directory a que o utilizador pertence.</span><span class="sxs-lookup"><span data-stu-id="9f14b-167">The ID for the Active Directory tenant that the user belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="9f14b-168">O ID do cliente de aplicação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-168">The application client ID.</span></span> |
| | `AZURE_USERNAME` | <span data-ttu-id="9f14b-169">O nome de utilizador para início de sessão.</span><span class="sxs-lookup"><span data-stu-id="9f14b-169">The username to log in with.</span></span> |
| | `AZURE_PASSWORD` | <span data-ttu-id="9f14b-170">A palavra-passe para início de sessão.</span><span class="sxs-lookup"><span data-stu-id="9f14b-170">The password to log in with.</span></span> |
| <span data-ttu-id="9f14b-171">__MSI__</span><span class="sxs-lookup"><span data-stu-id="9f14b-171">__MSI__</span></span> | | <span data-ttu-id="9f14b-172">A MSI não necessita de quaisquer credenciais para ser definida.</span><span class="sxs-lookup"><span data-stu-id="9f14b-172">MSI does not require any credentials to be set.</span></span> <span data-ttu-id="9f14b-173">A aplicação tem de estar em execução num recurso do Azure configurado para utilizar MSI.</span><span class="sxs-lookup"><span data-stu-id="9f14b-173">The application must be running on an Azure resource configured to use MSI.</span></span> <span data-ttu-id="9f14b-174">Para obter mais detalhes, consulte [Identidade de Serviço Gerida (MSI) para recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="9f14b-174">For details, see [Managed Service Identity (MSI) for Azure resources].</span></span> |

<span data-ttu-id="9f14b-175">Se precisar de ligar a um ponto final de cloud ou de gestão diferente da cloud pública predefinida do Azure, também pode definir as variáveis de ambiente indicadas a seguir.</span><span class="sxs-lookup"><span data-stu-id="9f14b-175">If you need to connect to a cloud or management endpoint other than the default Azure public cloud, you can also set the following environment variables.</span></span> <span data-ttu-id="9f14b-176">Os motivos mais comuns para defini-las são a utilização do Azure Stack, de uma cloud numa região geográfica diferente ou do modelo de implementação Clássico do Azure.</span><span class="sxs-lookup"><span data-stu-id="9f14b-176">The most common reasons to set them are if you use Azure Stack, a cloud in a different geographic region, or the Azure Classic deployment model.</span></span>

| <span data-ttu-id="9f14b-177">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="9f14b-177">Environment variable</span></span> | <span data-ttu-id="9f14b-178">Descrição</span><span class="sxs-lookup"><span data-stu-id="9f14b-178">Description</span></span>  |
|----------------------|--------------|
| `AZURE_ENVIRONMENT` | <span data-ttu-id="9f14b-179">O nome do ambiente de cloud para ligação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-179">The name of the cloud environment to connect to.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="9f14b-180">O ID de recurso de Active Directory a utilizar na ligação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-180">The Active Directory resource ID to use when connecting.</span></span> <span data-ttu-id="9f14b-181">Deve ser um URI que aponta para o ponto final de gestão.</span><span class="sxs-lookup"><span data-stu-id="9f14b-181">This should be a URI pointing to your management endpoint.</span></span> |

<span data-ttu-id="9f14b-182">Quando utilizar a autenticação baseada no ambiente, chame a função [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) para obter o objeto authorizer.</span><span class="sxs-lookup"><span data-stu-id="9f14b-182">When using environment-based authentication, call the [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) function to get your authorizer object.</span></span> <span data-ttu-id="9f14b-183">Este objeto é então definido na propriedade `Authorizer` dos clientes para permitir o acesso ao Azure.</span><span class="sxs-lookup"><span data-stu-id="9f14b-183">This object is then set on the `Authorizer` property of clients to allow them access to Azure.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := auth.NewAuthorizerFromEnvironment()
```

## <a name="use-file-based-authentication"></a><span data-ttu-id="9f14b-184">Utilizar a autenticação baseada em ficheiro</span><span class="sxs-lookup"><span data-stu-id="9f14b-184">Use file-based authentication</span></span>

<span data-ttu-id="9f14b-185">A Autenticação baseada em ficheiro só funciona com credenciais de cliente armazenadas num formato de ficheiro local gerado pela [CLI 2.0 do Azure](/cli/azure).</span><span class="sxs-lookup"><span data-stu-id="9f14b-185">File-based authentication only works with client credentials when they are stored in a local file format generated by [the Azure CLI 2.0](/cli/azure).</span></span> <span data-ttu-id="9f14b-186">Pode criar facilmente este ficheiro quando criar um novo principal de serviço com o parâmetro `--sdk-auth`.</span><span class="sxs-lookup"><span data-stu-id="9f14b-186">You can easily create this file when creating a new service principal with the `--sdk-auth` parameter.</span></span> <span data-ttu-id="9f14b-187">Se pretender utilizar a autenticação baseada em ficheiro, certifique-se de que este argumento é fornecido ao criar um principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="9f14b-187">If you plan on using file-based authentication, make sure that this argument is provided when creating a service principal.</span></span> <span data-ttu-id="9f14b-188">Uma vez que a CLI imprime a saída de dados `stdout`, redirecione-a para um ficheiro.</span><span class="sxs-lookup"><span data-stu-id="9f14b-188">Since the CLI prints output to `stdout`, redirect output to a file.</span></span>

```azurecli
az ad sp create-for-rbac --sdk-auth > azure.auth
```

<span data-ttu-id="9f14b-189">Defina a variável de ambiente `AZURE_AUTH_LOCATION` para onde está localizado o ficheiro de autorização.</span><span class="sxs-lookup"><span data-stu-id="9f14b-189">Set the `AZURE_AUTH_LOCATION` environment variable to where the authorization file is located.</span></span> <span data-ttu-id="9f14b-190">Esta variável de ambiente é lida pela aplicação e as credenciais que contém são analisadas.</span><span class="sxs-lookup"><span data-stu-id="9f14b-190">This environment variable is read by the application, and the credentials within it are parsed.</span></span> <span data-ttu-id="9f14b-191">Se tiver de selecionar o ficheiro de autorização em runtime, manipule o ambiente do programa utilizando a função [os.Setenv](https://golang.org/pkg/os/#Setenv).</span><span class="sxs-lookup"><span data-stu-id="9f14b-191">If you need to select the authorization file at runtime, manipulate the program's environment using the [os.Setenv](https://golang.org/pkg/os/#Setenv) function.</span></span>

<span data-ttu-id="9f14b-192">Para carregar as informações de autenticação, chame a função [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile).</span><span class="sxs-lookup"><span data-stu-id="9f14b-192">To load the authentication information, call the [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile) function.</span></span> <span data-ttu-id="9f14b-193">Ao contrário da autorização baseada no ambiente, a autorização baseada em ficheiro necessita de um ponto final de recurso.</span><span class="sxs-lookup"><span data-stu-id="9f14b-193">Unlike environment-based authorization, file-based authorization requires a resource endpoint.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := NewAuthorizerFromFile(azure.PublicCloud.ResourceManagerEndpoint)
```

<span data-ttu-id="9f14b-194">Para saber mais sobre a utilização de principais de serviço e a gestão das permissões de acesso, consulte [Criar um principal de serviço com a CLI 2.0 do Azure].</span><span class="sxs-lookup"><span data-stu-id="9f14b-194">For more on using service principals and managing their access permissions, see [Create a service principal with Azure CLI 2.0].</span></span>

## <a name="use-device-token-authentication"></a><span data-ttu-id="9f14b-195">Utilizar a autenticação de token de dispositivo</span><span class="sxs-lookup"><span data-stu-id="9f14b-195">Use device token authentication</span></span>

<span data-ttu-id="9f14b-196">Se pretender que os utilizadores iniciem sessão interativamente, a melhor forma para oferecer essa funcionalidade é através da autenticação de token de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="9f14b-196">If you want users to log in interactively, the best way to offer that capability is through device token authentication.</span></span> <span data-ttu-id="9f14b-197">Este fluxo de autenticação disponibiliza um token ao utilizador para ser colado num site de início de sessão da Microsoft, onde podem iniciar sessão com uma conta do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="9f14b-197">This authentication flow passes the user a token to paste into a Microsoft login site, where they then log in with an Azure Active Directory (AAD) account.</span></span> <span data-ttu-id="9f14b-198">Este método de autenticação suporta contas com a autenticação multifator ativada, ao contrário da autenticação de nome de utilizador/palavra-passe padrão.</span><span class="sxs-lookup"><span data-stu-id="9f14b-198">This authentication method supports accounts that have multi-factor authentication enabled, unlike standard username/password authentication.</span></span>

<span data-ttu-id="9f14b-199">Para utilizar a autenticação de token de dispositivo, crie um objeto authorizer [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) com a função [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig).</span><span class="sxs-lookup"><span data-stu-id="9f14b-199">To use device token authentication, create a [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) authorizer with the [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig) function.</span></span> <span data-ttu-id="9f14b-200">Chame [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) no objeto resultante para iniciar o processo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-200">Call [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) on the resulting object to start the authentication process.</span></span> <span data-ttu-id="9f14b-201">Os blocos de autenticação do fluxo do dispositivo programam a execução até todo o fluxo de autenticação ser concluído.</span><span class="sxs-lookup"><span data-stu-id="9f14b-201">Device flow authentication blocks program execution until the whole authentication flow is complete.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
deviceConfig := auth.NewDeviceFlowConfig(applicationID, tenantID)
authorizer, err := deviceConfig.Authorizer()
```

## <a name="use-an-authentication-client"></a><span data-ttu-id="9f14b-202">Utilizar um cliente de autenticação</span><span class="sxs-lookup"><span data-stu-id="9f14b-202">Use an authentication client</span></span>

<span data-ttu-id="9f14b-203">Se necessitar de um tipo de autenticação específico e quiser que o seu programa execute o carregamento das informações de autenticação do utilizador, pode utilizar qualquer cliente que esteja em conformidade com a interface [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig).</span><span class="sxs-lookup"><span data-stu-id="9f14b-203">If you require a specific type of authentication and are willing to have your program do the work to load authentication information from the user, you can use any client that conforms to the [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig) interface.</span></span> <span data-ttu-id="9f14b-204">Utilize um tipo que implemente esta interface quando pretender um programa interativo, utilizar ficheiros de configuração especializados ou tiver um requisito que o impede de utilizar outro método de autenticação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-204">Use a type that implements this interface when you want an interactive program, use specialized configuration files, or have a requirement that prevents you from using another authentication method.</span></span>

> [!WARNING]
> <span data-ttu-id="9f14b-205">Nunca utilize credenciais do Azure hard-coded numa aplicação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-205">Never hard-code Azure credentials into an application.</span></span> <span data-ttu-id="9f14b-206">Colocar segredos no binário de uma aplicação torna mais fácil para um atacante extrai-las, quer a aplicação esteja a ser executada ou não.</span><span class="sxs-lookup"><span data-stu-id="9f14b-206">Putting secrets into an application binary makes it easier for an attacker to extract them, whether the application is running or not.</span></span> <span data-ttu-id="9f14b-207">Tal coloca em risco todos os recursos do Azure para os quais as credenciais estão autorizadas!</span><span class="sxs-lookup"><span data-stu-id="9f14b-207">This puts all Azure resources the credentials are authorized for at risk!</span></span>

<span data-ttu-id="9f14b-208">A tabela seguinte lista os tipos no SDK que estão em conformidade com a interface `AuthorizerConfig`.</span><span class="sxs-lookup"><span data-stu-id="9f14b-208">The following table lists the types in the SDK that conform to the `AuthorizerConfig` interface.</span></span>

| <span data-ttu-id="9f14b-209">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="9f14b-209">Authentication type</span></span> | <span data-ttu-id="9f14b-210">Tipo de authorizer</span><span class="sxs-lookup"><span data-stu-id="9f14b-210">Authorizer type</span></span> |
|---------------------|-----------------------|
| <span data-ttu-id="9f14b-211">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="9f14b-211">Certificate-based authentication</span></span> | <span data-ttu-id="9f14b-212">[ClientCertificateConfig]</span><span class="sxs-lookup"><span data-stu-id="9f14b-212">[ClientCertificateConfig]</span></span> |
| <span data-ttu-id="9f14b-213">Credenciais de cliente</span><span class="sxs-lookup"><span data-stu-id="9f14b-213">Client credentials</span></span> | <span data-ttu-id="9f14b-214">[ClientCredentialsConfig]</span><span class="sxs-lookup"><span data-stu-id="9f14b-214">[ClientCredentialsConfig]</span></span> |
| <span data-ttu-id="9f14b-215">Identidade de Serviço Gerida (MSI)</span><span class="sxs-lookup"><span data-stu-id="9f14b-215">Managed Service Identity (MSI)</span></span> | <span data-ttu-id="9f14b-216">[MSIConfig]</span><span class="sxs-lookup"><span data-stu-id="9f14b-216">[MSIConfig]</span></span> |
| <span data-ttu-id="9f14b-217">Nome de utilizador/palavra-passe</span><span class="sxs-lookup"><span data-stu-id="9f14b-217">Username/password</span></span> | <span data-ttu-id="9f14b-218">[UsernamePasswordConfig]</span><span class="sxs-lookup"><span data-stu-id="9f14b-218">[UsernamePasswordConfig]</span></span> |

[ClientCertificateConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCertificateConfig
[ClientCredentialsConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCredentialsConfig
[MSIConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#MSIConfig
[DeviceFlowConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig
[UsernamePasswordConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#UsernamePasswordConfig

<span data-ttu-id="9f14b-223">Crie um autenticador com a função `New` associada e, em seguida, chame `Authorize` no objeto resultante para efetuar a autenticação.</span><span class="sxs-lookup"><span data-stu-id="9f14b-223">Create an authenticator with its associated `New` function, and then call `Authorize` on the resulting object to perform authentication.</span></span> <span data-ttu-id="9f14b-224">Por exemplo, para utilizar a autenticação baseada em certificado:</span><span class="sxs-lookup"><span data-stu-id="9f14b-224">For example, to use certificate-based authentication:</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
certificateAuthorizer := auth.NewClientCertificateConfig(certificatePath, certificatePassword, clientID, tenantID)
authorizerToken, err := certificateAuthorizer.Authorize()
```
