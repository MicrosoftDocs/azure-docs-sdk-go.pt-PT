---
title: Autenticação com o Azure SDK para Go
description: Saiba mais sobre os métodos de autenticação disponíveis no Azure SDK para Go e como utilizá-los.
services: azure
author: sptramer
ms.author: sttramer
manager: carmonm
ms.date: 09/05/2018
ms.topic: conceptual
ms.technology: azure-sdk-go
ms.devlang: go
ms.component: authentication
ms.openlocfilehash: c2c3dccfa8da5cfe57fee0b90139002068982560
ms.sourcegitcommit: 887b15afcdeaf926a5f3d21b64e4045167fd062c
ms.translationtype: HT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/21/2018
ms.locfileid: "49481987"
---
# <a name="authentication-methods-in-the-azure-sdk-for-go"></a><span data-ttu-id="cd634-103">Métodos de autenticação no Azure SDK para Go</span><span class="sxs-lookup"><span data-stu-id="cd634-103">Authentication methods in the Azure SDK for Go</span></span>

<span data-ttu-id="cd634-104">O SDK do Azure para Go oferece várias formas de efetuar a autenticação no Azure.</span><span class="sxs-lookup"><span data-stu-id="cd634-104">The Azure SDK for Go offers multiple ways to authenticate with Azure.</span></span> <span data-ttu-id="cd634-105">Estes _tipos_ de autenticação são invocados através de diferentes _métodos_ de autenticação.</span><span class="sxs-lookup"><span data-stu-id="cd634-105">These authentication _types_ are invoked through different authentication _methods_.</span></span> <span data-ttu-id="cd634-106">Este artigo aborda os tipos e métodos disponíveis, e como escolher os mais indicados para a sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="cd634-106">This article covers the available types, methods, and how to choose which are best for your application.</span></span>

## <a name="available-authentication-types-and-methods"></a><span data-ttu-id="cd634-107">Tipos e métodos de autenticação disponíveis</span><span class="sxs-lookup"><span data-stu-id="cd634-107">Available authentication types and methods</span></span>

<span data-ttu-id="cd634-108">O Azure SDK para Go oferece vários tipos diferentes de autenticação que utilizam conjuntos de credenciais diferentes.</span><span class="sxs-lookup"><span data-stu-id="cd634-108">The Azure SDK for Go offers several different types of authentication, using different credentials sets.</span></span> <span data-ttu-id="cd634-109">Cada tipo de autenticação está disponível através de diferentes métodos de autenticação, os quais correspondem ao modo como o SDK processa estas credenciais como entradas de dados.</span><span class="sxs-lookup"><span data-stu-id="cd634-109">Each authentication type is available through different authentication methods, which are how the SDK takes these credentials as input.</span></span> <span data-ttu-id="cd634-110">A tabela seguinte descreve os tipos de autenticação disponíveis e as situações em que são recomendados para utilização na sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="cd634-110">The following table describes the available types of authentication and situations in which they're recommended for use by your application.</span></span>

| <span data-ttu-id="cd634-111">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="cd634-111">Authentication type</span></span> | <span data-ttu-id="cd634-112">Recomendado quando...</span><span class="sxs-lookup"><span data-stu-id="cd634-112">Recommended when...</span></span> |
|---------------------|---------------------|
| <span data-ttu-id="cd634-113">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="cd634-113">Certificate-based authentication</span></span> | <span data-ttu-id="cd634-114">Tem um certificado X509 configurado para um utilizador ou principal de serviço do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="cd634-114">You have an X509 certificate that was configured for an Azure Active Directory (AAD) user or service principal.</span></span> <span data-ttu-id="cd634-115">Para obter mais informações, consulte [Introdução à autenticação baseada em certificado no Azure Active Directory].</span><span class="sxs-lookup"><span data-stu-id="cd634-115">To learn more, see [Get started with certificate-based authentication in Azure Active Directory].</span></span> |
| <span data-ttu-id="cd634-116">Credenciais de cliente</span><span class="sxs-lookup"><span data-stu-id="cd634-116">Client credentials</span></span> | <span data-ttu-id="cd634-117">Tem um principal de serviço configurado para esta aplicação ou uma classe de aplicações a que pertence.</span><span class="sxs-lookup"><span data-stu-id="cd634-117">You have a configured service principal that is set up for this application or a class of applications it belongs to.</span></span> <span data-ttu-id="cd634-118">Para obter mais informações, veja [Criar um principal de serviço com a CLI do Azure].</span><span class="sxs-lookup"><span data-stu-id="cd634-118">To learn more, see [Create a service principal with Azure CLI].</span></span> |
| <span data-ttu-id="cd634-119">Identidades geridas para os recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="cd634-119">Managed identities for Azure resources</span></span> | <span data-ttu-id="cd634-120">A aplicação está a ser executada num recurso do Azure configurado com uma identidade gerida.</span><span class="sxs-lookup"><span data-stu-id="cd634-120">Your application is running on an Azure resource that has been configured with a managed identity.</span></span> <span data-ttu-id="cd634-121">Para saber mais, veja [Identidades geridas para os recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="cd634-121">To learn more, see [Managed identities for Azure resources].</span></span> |
| <span data-ttu-id="cd634-122">Token de dispositivo</span><span class="sxs-lookup"><span data-stu-id="cd634-122">Device token</span></span> | <span data-ttu-id="cd634-123">A sua aplicação destina-se a ser utilizada __apenas__ de forma interativa.</span><span class="sxs-lookup"><span data-stu-id="cd634-123">Your application is meant to be used interactively __only__.</span></span> <span data-ttu-id="cd634-124">Os utilizadores podem ter a autenticação multifator ativada.</span><span class="sxs-lookup"><span data-stu-id="cd634-124">Users may have multi-factor authentication enabled.</span></span> <span data-ttu-id="cd634-125">Os utilizadores têm acesso a um browser para iniciar sessão.</span><span class="sxs-lookup"><span data-stu-id="cd634-125">Users have access to a web browser to sign in.</span></span> <span data-ttu-id="cd634-126">Para obter mais informações, consulte [Utilizar a autenticação de token de dispositivo](#use-device-token-authentication).</span><span class="sxs-lookup"><span data-stu-id="cd634-126">For more information, see [Use device token authentication](#use-device-token-authentication).</span></span>|
| <span data-ttu-id="cd634-127">Nome de utilizador/palavra-passe</span><span class="sxs-lookup"><span data-stu-id="cd634-127">Username/password</span></span> | <span data-ttu-id="cd634-128">Tem uma aplicação interativa que não pode utilizar qualquer outro método de autenticação.</span><span class="sxs-lookup"><span data-stu-id="cd634-128">You have an interactive application that can't use any other authentication method.</span></span> <span data-ttu-id="cd634-129">Os utilizadores não têm a autenticação multifator ativada para o início de sessão do AAD.</span><span class="sxs-lookup"><span data-stu-id="cd634-129">Your users don't have multi-factor authentication enabled for their AAD sign-in.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="cd634-130">Se utilizar outro tipo de autenticação que não as credenciais do cliente, a aplicação tem de estar registada no Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="cd634-130">If you use an authentication type other than client credentials, your application must be registered in Azure Active Directory.</span></span> <span data-ttu-id="cd634-131">Para obter mais informações, consulte [Integrar aplicações no Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="cd634-131">To learn how, see [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>
>
> [!NOTE]
> <span data-ttu-id="cd634-132">A menos que tenha requisitos especiais, evite a autenticação de nome de utilizador/palavra-passe.</span><span class="sxs-lookup"><span data-stu-id="cd634-132">Unless you have special requirements, avoid username/password authentication.</span></span> <span data-ttu-id="cd634-133">Em situações em que o início de sessão baseado no utilizador é adequado, a autenticação de token de dispositivo pode ser utilizada como alternativa.</span><span class="sxs-lookup"><span data-stu-id="cd634-133">In situations where user-based sign in is appropriate, device token authentication can usually be used instead.</span></span>

[Introdução à autenticação baseada em certificado no Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Get started with certificate-based authentication in Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Criar um principal de serviço com a CLI do Azure]: /cli/azure/create-an-azure-service-principal-azure-cli
[Create a service principal with Azure CLI]: /cli/azure/create-an-azure-service-principal-azure-cli
[Identidades geridas para os recursos do Azure]: /azure/active-directory/managed-identities-azure-resources/overview
[Managed identities for Azure resources]: /azure/active-directory/managed-identities-azure-resources/overview

<span data-ttu-id="cd634-137">Estes tipos de autenticação estão disponíveis através de métodos diferentes.</span><span class="sxs-lookup"><span data-stu-id="cd634-137">These authentication types are available through different methods.</span></span>

* <span data-ttu-id="cd634-138">A [_autenticação baseada no ambiente_ ](#use-environment-based-authentication) lê as credenciais diretamente a partir do ambiente do programa.</span><span class="sxs-lookup"><span data-stu-id="cd634-138">[_Environment-based authentication_](#use-environment-based-authentication) reads credentials directly from the program's environment.</span></span>
* <span data-ttu-id="cd634-139">A [_autenticação baseada em ficheiro_ ](#use-file-based-authentication) carrega um ficheiro que contém as credenciais do principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="cd634-139">[_File-based authentication_](#use-file-based-authentication) loads a file containing service principal credentials.</span></span>
* <span data-ttu-id="cd634-140">A [_autenticação baseada no cliente_](#use-an-authentication-client) utiliza um objeto no código e atribui ao utilizador a responsabilidade de fornecer as credenciais durante a execução do programa.</span><span class="sxs-lookup"><span data-stu-id="cd634-140">[_Client-based authentication_](#use-an-authentication-client) uses an object in code and makes you responsible for providing the credentials during program execution.</span></span>
* <span data-ttu-id="cd634-141">A [_autenticação de token de dispositivo_](#use-device-token-authentication) necessita que os utilizadores iniciem sessão de forma interativa através de um browser com um token.</span><span class="sxs-lookup"><span data-stu-id="cd634-141">[_Device token authentication_](#use-device-token-authentication) requires users to sign in interactively through a web browser with a token.</span></span>

<span data-ttu-id="cd634-142">Todas as funções de autenticação e tipos estão disponíveis no pacote `github.com/Azure/go-autorest/autorest/azure/auth`.</span><span class="sxs-lookup"><span data-stu-id="cd634-142">All authentication functions and types are available in the `github.com/Azure/go-autorest/autorest/azure/auth` package.</span></span>

> [!NOTE]
> <span data-ttu-id="cd634-143">Exceto se tiver requisitos especiais, evite utilizar a autenticação baseada no cliente.</span><span class="sxs-lookup"><span data-stu-id="cd634-143">Unless you have special requirements, avoid client-based authentication.</span></span> <span data-ttu-id="cd634-144">Este método de autenticação encoraja práticas incorretas.</span><span class="sxs-lookup"><span data-stu-id="cd634-144">This method of authentication encourages bad practices.</span></span> <span data-ttu-id="cd634-145">Em particular, utilizar a autenticação baseada em cliente convida à criação de credenciais hard-coded.</span><span class="sxs-lookup"><span data-stu-id="cd634-145">In particular, using client-based authentication makes it tempting to hard-code credentials.</span></span> <span data-ttu-id="cd634-146">Escrever código personalizado para autenticação também poderá resultar em erros em versões futuras do SDK caso os requisitos de autenticação mudem.</span><span class="sxs-lookup"><span data-stu-id="cd634-146">Writing custom code for authentication may also break under future SDK releases if authentication requirements change.</span></span>

## <a name="use-environment-based-authentication"></a><span data-ttu-id="cd634-147">Utilizar a autenticação baseada no ambiente</span><span class="sxs-lookup"><span data-stu-id="cd634-147">Use environment-based authentication</span></span>

<span data-ttu-id="cd634-148">Se estiver a executar a aplicação num ambiente controlado, a autenticação baseada no ambiente é uma opção natural.</span><span class="sxs-lookup"><span data-stu-id="cd634-148">If you're running your application in a controlled setting, environment-based authentication is a natural choice.</span></span> <span data-ttu-id="cd634-149">Com este método de autenticação, é possível configurar o ambiente da shell antes de executar a aplicação.</span><span class="sxs-lookup"><span data-stu-id="cd634-149">With this authentication method, you configure the shell environment before running your application.</span></span> <span data-ttu-id="cd634-150">Em runtime, o SDK para Go lê estas variáveis de ambiente de modo a efetuar a autenticação no Azure.</span><span class="sxs-lookup"><span data-stu-id="cd634-150">At runtime, the Go SDK reads these environment variables to authenticate with Azure.</span></span>

<span data-ttu-id="cd634-151">A autenticação baseada no ambiente suporta todos os métodos de autenticação exceto tokens de dispositivo, avaliados pela seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="cd634-151">Environment-based authentication has support for all authentication methods except device tokens, evaluated in the following order:</span></span>

* <span data-ttu-id="cd634-152">Credenciais de cliente</span><span class="sxs-lookup"><span data-stu-id="cd634-152">Client credentials</span></span>
* <span data-ttu-id="cd634-153">Certificados X509</span><span class="sxs-lookup"><span data-stu-id="cd634-153">X509 certificates</span></span>
* <span data-ttu-id="cd634-154">Nome de utilizador/palavra-passe</span><span class="sxs-lookup"><span data-stu-id="cd634-154">Username/password</span></span>
* <span data-ttu-id="cd634-155">Identidades geridas para os recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="cd634-155">Managed identities for Azure resources</span></span>

<span data-ttu-id="cd634-156">Se um determinado tipo de autenticação tiver valores não definidos ou for recusado, o SDK tenta automaticamente o tipo de autenticação seguinte.</span><span class="sxs-lookup"><span data-stu-id="cd634-156">If an authentication type has unset values or is refused, the SDK automatically tries the next authentication type.</span></span> <span data-ttu-id="cd634-157">Quando já não houver mais tipos disponíveis para experimentar, o SDK devolve um erro.</span><span class="sxs-lookup"><span data-stu-id="cd634-157">When no more types are available to try, the SDK returns an error.</span></span>

<span data-ttu-id="cd634-158">A tabela seguinte fornece detalhes sobre as variáveis de ambiente que têm de ser definidas para cada tipo de autenticação suportado pela autenticação baseada no ambiente.</span><span class="sxs-lookup"><span data-stu-id="cd634-158">The following table details the environment variables that need to be set for each authentication type supported by environment-based authentication.</span></span>


|  <span data-ttu-id="cd634-159">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="cd634-159">Authentication type</span></span>   |     <span data-ttu-id="cd634-160">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="cd634-160">Environment variable</span></span>     |                                                                                                     <span data-ttu-id="cd634-161">Descrição</span><span class="sxs-lookup"><span data-stu-id="cd634-161">Description</span></span>                                                                                                      |
|------------------------|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="cd634-162">**Credenciais de cliente**</span><span class="sxs-lookup"><span data-stu-id="cd634-162">**Client credentials**</span></span> |      `AZURE_TENANT_ID`       |                                                                    <span data-ttu-id="cd634-163">O ID do inquilino do Active Directory a que o principal de serviço pertence.</span><span class="sxs-lookup"><span data-stu-id="cd634-163">The ID for the Active Directory tenant that the service principal belongs to.</span></span>                                                                     |
|                        |      `AZURE_CLIENT_ID`       |                                                                                       <span data-ttu-id="cd634-164">O nome ou o ID do principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="cd634-164">The name or ID of the service principal.</span></span>                                                                                       |
|                        |    `AZURE_CLIENT_SECRET`     |                                                                                  <span data-ttu-id="cd634-165">O segredo associado ao principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="cd634-165">The secret associated with the service principal.</span></span>                                                                                   |
|    <span data-ttu-id="cd634-166">**Certificado**</span><span class="sxs-lookup"><span data-stu-id="cd634-166">**Certificate**</span></span>     |      `AZURE_TENANT_ID`       |                                                                   <span data-ttu-id="cd634-167">O ID do inquilino do Active Directory com o qual o certificado está registado.</span><span class="sxs-lookup"><span data-stu-id="cd634-167">The ID for the Active Directory tenant that the certificate is registered with.</span></span>                                                                    |
|                        |      `AZURE_CLIENT_ID`       |                                                                              <span data-ttu-id="cd634-168">O ID de cliente de aplicação associado ao certificado.</span><span class="sxs-lookup"><span data-stu-id="cd634-168">The application client ID associated with the certificate.</span></span>                                                                              |
|                        |   `AZURE_CERTIFICATE_PATH`   |                                                                                       <span data-ttu-id="cd634-169">O caminho para o ficheiro de certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="cd634-169">The path to the client certificate file.</span></span>                                                                                       |
|                        | `AZURE_CERTIFICATE_PASSWORD` |                                                                                       <span data-ttu-id="cd634-170">A palavra-passe do certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="cd634-170">The password for the client certificate.</span></span>                                                                                       |
| <span data-ttu-id="cd634-171">**Nome de Utilizador/Palavra-passe**</span><span class="sxs-lookup"><span data-stu-id="cd634-171">**Username/Password**</span></span>  |      `AZURE_TENANT_ID`       |                                                                           <span data-ttu-id="cd634-172">O ID do inquilino do Active Directory a que o utilizador pertence.</span><span class="sxs-lookup"><span data-stu-id="cd634-172">The ID for the Active Directory tenant that the user belongs to.</span></span>                                                                           |
|                        |      `AZURE_CLIENT_ID`       |                                                                                              <span data-ttu-id="cd634-173">O ID do cliente de aplicação.</span><span class="sxs-lookup"><span data-stu-id="cd634-173">The application client ID.</span></span>                                                                                              |
|                        |       `AZURE_USERNAME`       |                                                                                            <span data-ttu-id="cd634-174">O nome de utilizador para início de sessão.</span><span class="sxs-lookup"><span data-stu-id="cd634-174">The username to sign in with.</span></span>                                                                                             |
|                        |       `AZURE_PASSWORD`       |                                                                                            <span data-ttu-id="cd634-175">A palavra-passe para início de sessão.</span><span class="sxs-lookup"><span data-stu-id="cd634-175">The password to sign in with.</span></span>                                                                                             |
|  <span data-ttu-id="cd634-176">**Identidade gerida**</span><span class="sxs-lookup"><span data-stu-id="cd634-176">**Managed identity**</span></span>  |                              | <span data-ttu-id="cd634-177">Não são necessárias credenciais para a autenticação de identidade gerida.</span><span class="sxs-lookup"><span data-stu-id="cd634-177">No credentials are needed for managed identity authentication.</span></span> <span data-ttu-id="cd634-178">A aplicação tem de estar em execução num recurso do Azure configurado para utilizar as identidades geridas.</span><span class="sxs-lookup"><span data-stu-id="cd634-178">The application must be running on an Azure resource configured to use managed identities.</span></span> <span data-ttu-id="cd634-179">Para mais detalhes, veja [Identidades geridas para os recursos do Azure].</span><span class="sxs-lookup"><span data-stu-id="cd634-179">For details, see [Managed identities for Azure resources].</span></span> |

<span data-ttu-id="cd634-180">Para ligar a uma cloud ou a um ponto final de gestão sem ser a cloud pública predefinida do Azure, defina as variáveis de ambiente indicadas a seguir.</span><span class="sxs-lookup"><span data-stu-id="cd634-180">To connect to a cloud or management endpoint other than the default Azure public cloud, set the following environment variables.</span></span> <span data-ttu-id="cd634-181">As razões mais comuns são a utilização do Azure Stack, de uma cloud numa região geográfica diferente ou do modelo de implementação clássico.</span><span class="sxs-lookup"><span data-stu-id="cd634-181">The most common reasons are if you use Azure Stack, a cloud in a different geographic region, or the classic deployment model.</span></span>

| <span data-ttu-id="cd634-182">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="cd634-182">Environment variable</span></span> | <span data-ttu-id="cd634-183">Descrição</span><span class="sxs-lookup"><span data-stu-id="cd634-183">Description</span></span>  |
|----------------------|--------------|
| `AZURE_ENVIRONMENT` | <span data-ttu-id="cd634-184">O nome do ambiente de cloud para ligação.</span><span class="sxs-lookup"><span data-stu-id="cd634-184">The name of the cloud environment to connect to.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="cd634-185">O ID de recurso do Active Directory a utilizar ao estabelecer ligação, como um URI para o ponto final de gestão.</span><span class="sxs-lookup"><span data-stu-id="cd634-185">The Active Directory resource ID to use when connecting, as a URI to your management endpoint.</span></span> |

<span data-ttu-id="cd634-186">Quando utilizar a autenticação baseada no ambiente, chame a função [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) para obter o objeto authorizer.</span><span class="sxs-lookup"><span data-stu-id="cd634-186">When using environment-based authentication, call the [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) function to get your authorizer object.</span></span> <span data-ttu-id="cd634-187">Este objeto é então definido na propriedade `Authorizer` dos clientes para permitir o acesso ao Azure.</span><span class="sxs-lookup"><span data-stu-id="cd634-187">This object is then set on the `Authorizer` property of clients to allow them access to Azure.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := auth.NewAuthorizerFromEnvironment()
```

### <a name="authentication-on-azure-stack"></a><span data-ttu-id="cd634-188">Autenticação no Azure Stack</span><span class="sxs-lookup"><span data-stu-id="cd634-188">Authentication on Azure Stack</span></span>

<span data-ttu-id="cd634-189">Para autenticar no Azure Stack, tem de definir as seguintes variáveis:</span><span class="sxs-lookup"><span data-stu-id="cd634-189">To authenticate on Azure Stack, you need to set the following variables:</span></span>

| <span data-ttu-id="cd634-190">Variável de ambiente</span><span class="sxs-lookup"><span data-stu-id="cd634-190">Environment variable</span></span> | <span data-ttu-id="cd634-191">Descrição</span><span class="sxs-lookup"><span data-stu-id="cd634-191">Description</span></span>  |
|----------------------|--------------|
| `AZURE_AD_ENDPOINT` | <span data-ttu-id="cd634-192">O ponto final do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="cd634-192">The Active Directory endpoint.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="cd634-193">O ID de recurso do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="cd634-193">The Active Directory resource ID.</span></span> |

<span data-ttu-id="cd634-194">Estas variáveis podem ser obtidas a partir das informações de metadados do Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="cd634-194">These variables can be retrieved from Azure Stack metadata information.</span></span> <span data-ttu-id="cd634-195">Para obter os metadados, abra um browser web no seu ambiente do Azure Stack e utilize o url: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span><span class="sxs-lookup"><span data-stu-id="cd634-195">To retrieve the metadata, open a web browser in your Azure Stack environment and use the url: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span></span>

<span data-ttu-id="cd634-196">O `ResourceManagerURL` varia consoante o nome da região, o nome da máquina e o nome do domínio completamente qualificado (FQDN) externo da sua implementação do Azure Stack:</span><span class="sxs-lookup"><span data-stu-id="cd634-196">The `ResourceManagerURL` varies based on the region name, machine name, and external fully qualified domain name (FQDN) of your Azure Stack deployment:</span></span>

| <span data-ttu-id="cd634-197">Ambiente</span><span class="sxs-lookup"><span data-stu-id="cd634-197">Environment</span></span> | <span data-ttu-id="cd634-198">ResourceManagerURL</span><span class="sxs-lookup"><span data-stu-id="cd634-198">ResourceManagerURL</span></span> |
|----------------------|--------------|
| <span data-ttu-id="cd634-199">Kit de Desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="cd634-199">Development Kit</span></span> | `https://management.local.azurestack.external/` |
| <span data-ttu-id="cd634-200">Sistemas Integrados</span><span class="sxs-lookup"><span data-stu-id="cd634-200">Integrated Systems</span></span> | `https://management.(region).ext-(machine-name).(FQDN)` |

<span data-ttu-id="cd634-201">Para obter mais informações sobre como utilizar o SDK do Azure para Go no Azure Stack, veja [Utilizar perfis de versão de API com o Go no Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span><span class="sxs-lookup"><span data-stu-id="cd634-201">For more information on how to use the Azure SDK for Go on Azure Stack, see [Use API version profiles with Go in Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span></span>

## <a name="use-file-based-authentication"></a><span data-ttu-id="cd634-202">Utilizar a autenticação baseada em ficheiro</span><span class="sxs-lookup"><span data-stu-id="cd634-202">Use file-based authentication</span></span>

<span data-ttu-id="cd634-203">A autenticação baseada em ficheiros utiliza um formato de ficheiro gerado pela [CLI do Azure](/cli/azure).</span><span class="sxs-lookup"><span data-stu-id="cd634-203">File-based authentication uses a file format generated by [the Azure CLI](/cli/azure).</span></span> <span data-ttu-id="cd634-204">Pode criar facilmente este ficheiro quando criar um novo principal de serviço com o parâmetro `--sdk-auth`.</span><span class="sxs-lookup"><span data-stu-id="cd634-204">You can easily create this file when creating a new service principal with the `--sdk-auth` parameter.</span></span> <span data-ttu-id="cd634-205">Se pretender utilizar a autenticação baseada em ficheiro, certifique-se de que este argumento é fornecido ao criar um principal de serviço.</span><span class="sxs-lookup"><span data-stu-id="cd634-205">If you plan on using file-based authentication, make sure that this argument is provided when creating a service principal.</span></span> <span data-ttu-id="cd634-206">Uma vez que a CLI imprime a saída de dados `stdout`, redirecione-a para um ficheiro.</span><span class="sxs-lookup"><span data-stu-id="cd634-206">Since the CLI prints output to `stdout`, redirect output to a file.</span></span>

```azurecli
az ad sp create-for-rbac --sdk-auth > azure.auth
```

<span data-ttu-id="cd634-207">Defina a variável de ambiente `AZURE_AUTH_LOCATION` para onde está localizado o ficheiro de autorização.</span><span class="sxs-lookup"><span data-stu-id="cd634-207">Set the `AZURE_AUTH_LOCATION` environment variable to where the authorization file is located.</span></span> <span data-ttu-id="cd634-208">Esta variável de ambiente é lida pela aplicação e as credenciais que contém são analisadas.</span><span class="sxs-lookup"><span data-stu-id="cd634-208">This environment variable is read by the application, and the credentials within it are parsed.</span></span> <span data-ttu-id="cd634-209">Se tiver de selecionar o ficheiro de autorização em runtime, manipule o ambiente do programa utilizando a função [os.Setenv](https://golang.org/pkg/os/#Setenv).</span><span class="sxs-lookup"><span data-stu-id="cd634-209">If you need to select the authorization file at runtime, manipulate the program's environment using the [os.Setenv](https://golang.org/pkg/os/#Setenv) function.</span></span>

<span data-ttu-id="cd634-210">Para carregar as informações de autenticação, chame a função [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile).</span><span class="sxs-lookup"><span data-stu-id="cd634-210">To load the authentication information, call the [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile) function.</span></span> <span data-ttu-id="cd634-211">Ao contrário da autorização baseada no ambiente, a autorização baseada em ficheiro necessita de um ponto final de recurso.</span><span class="sxs-lookup"><span data-stu-id="cd634-211">Unlike environment-based authorization, file-based authorization requires a resource endpoint.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := NewAuthorizerFromFile(azure.PublicCloud.ResourceManagerEndpoint)
```

<span data-ttu-id="cd634-212">Para saber mais sobre a utilização de principais de serviço e a gestão das permissões de acesso, veja [Criar um principal de serviço com a CLI do Azure].</span><span class="sxs-lookup"><span data-stu-id="cd634-212">For more on using service principals and managing their access permissions, see [Create a service principal with Azure CLI].</span></span>

## <a name="use-device-token-authentication"></a><span data-ttu-id="cd634-213">Utilizar a autenticação de token de dispositivo</span><span class="sxs-lookup"><span data-stu-id="cd634-213">Use device token authentication</span></span>

<span data-ttu-id="cd634-214">Se pretender que os utilizadores iniciem sessão de forma interativa, a melhor maneira de o fazer é através da autenticação de token de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cd634-214">If you want users to sign in interactively, the best way is through device token authentication.</span></span> <span data-ttu-id="cd634-215">Este fluxo de autenticação disponibiliza um token ao utilizador para ser colado num site de início de sessão da Microsoft, onde podem autenticar com uma conta do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="cd634-215">This authentication flow passes the user a token to paste into a Microsoft sign-in site, where they then authenticate with an Azure Active Directory (AAD) account.</span></span> <span data-ttu-id="cd634-216">Este método de autenticação suporta contas com a autenticação multifator ativada, ao contrário da autenticação de nome de utilizador/palavra-passe padrão.</span><span class="sxs-lookup"><span data-stu-id="cd634-216">This authentication method supports accounts that have multi-factor authentication enabled, unlike standard username/password authentication.</span></span>

<span data-ttu-id="cd634-217">Para utilizar a autenticação de token de dispositivo, crie um objeto authorizer [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) com a função [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig).</span><span class="sxs-lookup"><span data-stu-id="cd634-217">To use device token authentication, create a [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) authorizer with the [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig) function.</span></span> <span data-ttu-id="cd634-218">Chame [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) no objeto resultante para iniciar o processo de autenticação.</span><span class="sxs-lookup"><span data-stu-id="cd634-218">Call [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) on the resulting object to start the authentication process.</span></span> <span data-ttu-id="cd634-219">Os blocos de autenticação do fluxo do dispositivo programam a execução até todo o fluxo de autenticação ser concluído.</span><span class="sxs-lookup"><span data-stu-id="cd634-219">Device flow authentication blocks program execution until the whole authentication flow is complete.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
deviceConfig := auth.NewDeviceFlowConfig(applicationID, tenantID)
authorizer, err := deviceConfig.Authorizer()
```

## <a name="use-an-authentication-client"></a><span data-ttu-id="cd634-220">Utilizar um cliente de autenticação</span><span class="sxs-lookup"><span data-stu-id="cd634-220">Use an authentication client</span></span>

<span data-ttu-id="cd634-221">Se necessitar de um tipo de autenticação específico e quiser que o seu programa execute o carregamento das informações de autenticação do utilizador, pode utilizar qualquer cliente que esteja em conformidade com a interface [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig).</span><span class="sxs-lookup"><span data-stu-id="cd634-221">If you require a specific type of authentication and are willing to have your program do the work to load authentication information from the user, you can use any client that conforms to the [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig) interface.</span></span> <span data-ttu-id="cd634-222">Utilize um tipo que implemente esta interface quando:</span><span class="sxs-lookup"><span data-stu-id="cd634-222">Use a type that implements this interface when you:</span></span>

* <span data-ttu-id="cd634-223">Escrever um programa interativo</span><span class="sxs-lookup"><span data-stu-id="cd634-223">Write an interactive program</span></span>
* <span data-ttu-id="cd634-224">Utilizar ficheiros de configuração especializados</span><span class="sxs-lookup"><span data-stu-id="cd634-224">Use specialized configuration files</span></span>
* <span data-ttu-id="cd634-225">Tiver um requisito que o impede de utilizar um método de autenticação incorporado</span><span class="sxs-lookup"><span data-stu-id="cd634-225">Have a requirement that prevents using a built-in authentication method</span></span>

> [!WARNING]
> <span data-ttu-id="cd634-226">Nunca utilize credenciais do Azure hard-coded numa aplicação.</span><span class="sxs-lookup"><span data-stu-id="cd634-226">Never hard-code Azure credentials into an application.</span></span> <span data-ttu-id="cd634-227">Colocar segredos no binário de uma aplicação torna mais fácil para um atacante extrai-las, quer a aplicação esteja a ser executada ou não.</span><span class="sxs-lookup"><span data-stu-id="cd634-227">Putting secrets into an application binary makes it easier for an attacker to extract them, whether the application is running or not.</span></span> <span data-ttu-id="cd634-228">Tal coloca em risco todos os recursos do Azure para os quais as credenciais estão autorizadas!</span><span class="sxs-lookup"><span data-stu-id="cd634-228">This puts all Azure resources the credentials are authorized for at risk!</span></span>

<span data-ttu-id="cd634-229">A tabela seguinte lista os tipos no SDK que estão em conformidade com a interface `AuthorizerConfig`.</span><span class="sxs-lookup"><span data-stu-id="cd634-229">The following table lists the types in the SDK that conform to the `AuthorizerConfig` interface.</span></span>

| <span data-ttu-id="cd634-230">Tipo de autenticação</span><span class="sxs-lookup"><span data-stu-id="cd634-230">Authentication type</span></span> | <span data-ttu-id="cd634-231">Tipo de authorizer</span><span class="sxs-lookup"><span data-stu-id="cd634-231">Authorizer type</span></span> |
|---------------------|-----------------------|
| <span data-ttu-id="cd634-232">Autenticação baseada em certificado</span><span class="sxs-lookup"><span data-stu-id="cd634-232">Certificate-based authentication</span></span> | <span data-ttu-id="cd634-233">[ClientCertificateConfig]</span><span class="sxs-lookup"><span data-stu-id="cd634-233">[ClientCertificateConfig]</span></span> |
| <span data-ttu-id="cd634-234">Credenciais de cliente</span><span class="sxs-lookup"><span data-stu-id="cd634-234">Client credentials</span></span> | <span data-ttu-id="cd634-235">[ClientCredentialsConfig]</span><span class="sxs-lookup"><span data-stu-id="cd634-235">[ClientCredentialsConfig]</span></span> |
| <span data-ttu-id="cd634-236">Identidades geridas para os recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="cd634-236">Managed identities for Azure resources</span></span> | <span data-ttu-id="cd634-237">[MSIConfig]</span><span class="sxs-lookup"><span data-stu-id="cd634-237">[MSIConfig]</span></span> |
| <span data-ttu-id="cd634-238">Nome de utilizador/palavra-passe</span><span class="sxs-lookup"><span data-stu-id="cd634-238">Username/password</span></span> | <span data-ttu-id="cd634-239">[UsernamePasswordConfig]</span><span class="sxs-lookup"><span data-stu-id="cd634-239">[UsernamePasswordConfig]</span></span> |

[ClientCertificateConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCertificateConfig
[ClientCredentialsConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCredentialsConfig
[MSIConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#MSIConfig
[DeviceFlowConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig
[UsernamePasswordConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#UsernamePasswordConfig

<span data-ttu-id="cd634-244">Crie um autenticador com a função `New` associada e, em seguida, chame `Authorize` no objeto resultante para efetuar a autenticação.</span><span class="sxs-lookup"><span data-stu-id="cd634-244">Create an authenticator with its associated `New` function, and then call `Authorize` on the resulting object to authenticate.</span></span> <span data-ttu-id="cd634-245">Por exemplo, para utilizar a autenticação baseada em certificado:</span><span class="sxs-lookup"><span data-stu-id="cd634-245">For example, to use certificate-based authentication:</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
certificateAuthorizer := auth.NewClientCertificateConfig(certificatePath, certificatePassword, clientID, tenantID)
authorizerToken, err := certificateAuthorizer.Authorize()
```
